<ResourceDictionary
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:ui="http://schemas.lepo.co/wpfui/2022/xaml"
    xmlns:controls="clr-namespace:PopupBlocker.Controls"
    xmlns:converters="clr-namespace:PopupBlocker.Converters">
    <!--#region Converters-->
    <converters:RemoveRuleParameterConverter x:Key="RemoveRuleParameterConverter"/>
    <!--#endregion-->

    <!--#region Common Style-->
    <Style x:Key="ElementBorder" TargetType="Border">
        <Setter Property="Margin" Value="0,0,10,0"/>
    </Style>

    <Style x:Key="IconOnlyUIButton" TargetType="ui:Button">
        <Setter Property="Background" Value="{DynamicResource ButtonBackground}" />
        <Setter Property="MouseOverBackground" Value="{DynamicResource ButtonBackgroundPointerOver}" />
        <Setter Property="PressedBackground" Value="{DynamicResource ButtonBackgroundPressed}" />
        <Setter Property="Foreground" Value="{DynamicResource ButtonForeground}" />
        <Setter Property="PressedForeground" Value="{DynamicResource ButtonForegroundPressed}" />
        <Setter Property="BorderBrush" Value="{DynamicResource ControlElevationBorderBrush}" />
        <Setter Property="PressedBorderBrush" Value="{DynamicResource ButtonBorderBrushPressed}" />
        <Setter Property="MouseOverBorderBrush" Value="{DynamicResource ControlElevationBorderBrush}" />
        <Setter Property="FontSize" Value="{DynamicResource ControlContentThemeFontSize}" />
        <Setter Property="Appearance" Value="Secondary" />
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="ui:Button">
                    <Grid>
                        <Ellipse x:Name="ContentEllipse"
                            Fill="{TemplateBinding Background}" Stroke="{TemplateBinding BorderBrush}"
                            Height="{Binding Width,RelativeSource={RelativeSource Self}}"/>
                        <ContentPresenter x:Name="ControlIcon"
                            Margin="5"
                            HorizontalAlignment="Center"
                            VerticalAlignment="Center"
                            Content="{TemplateBinding Icon}"
                            ContentTemplate="{TemplateBinding ContentTemplate}"
                            Focusable="False"
                            TextElement.FontSize="{TemplateBinding FontSize}"
                            TextElement.Foreground="{TemplateBinding Foreground}"/>
                    </Grid>
                    <ControlTemplate.Triggers>
                        <MultiTrigger>
                            <MultiTrigger.Conditions>
                                <Condition Property="IsMouseOver" Value="True" />
                                <Condition Property="IsPressed" Value="False" />
                            </MultiTrigger.Conditions>
                            <Setter TargetName="ContentEllipse" Property="Fill" Value="{Binding MouseOverBackground, RelativeSource={RelativeSource TemplatedParent}}" />
                            <Setter TargetName="ContentEllipse" Property="Stroke" Value="{Binding MouseOverBorderBrush, RelativeSource={RelativeSource TemplatedParent}}" />
                        </MultiTrigger>
                        <MultiTrigger>
                            <MultiTrigger.Conditions>
                                <Condition Property="IsMouseOver" Value="True" />
                                <Condition Property="IsPressed" Value="True" />
                            </MultiTrigger.Conditions>
                            <Setter TargetName="ContentEllipse" Property="Fill" Value="{Binding PressedBackground, RelativeSource={RelativeSource TemplatedParent}}" />
                            <Setter TargetName="ContentEllipse" Property="Stroke" Value="{Binding PressedBorderBrush, RelativeSource={RelativeSource TemplatedParent}}" />
                            <Setter TargetName="ControlIcon" Property="TextElement.Foreground" Value="{Binding PressedForeground, RelativeSource={RelativeSource TemplatedParent}}" />
                        </MultiTrigger>
                        <Trigger Property="IsEnabled" Value="False">
                            <Setter TargetName="ContentEllipse" Property="Fill" Value="{DynamicResource ButtonBackgroundDisabled}" />
                            <Setter TargetName="ContentEllipse" Property="Stroke" Value="{DynamicResource ButtonBorderBrushDisabled}" />
                            <Setter TargetName="ControlIcon" Property="TextElement.Foreground" Value="{DynamicResource ButtonForegroundDisabled}" />
                        </Trigger>
                    </ControlTemplate.Triggers>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
        <Style.Triggers>
            <!--  TRANSPARENT  -->
            <Trigger Property="Appearance" Value="Transparent">
                <Setter Property="Background" Value="Transparent" />
            </Trigger>

            <!--  PRIMARY  -->
            <Trigger Property="Appearance" Value="Primary">
                <Setter Property="Background" Value="{DynamicResource AccentButtonBackground}" />
                <Setter Property="MouseOverBackground" Value="{DynamicResource AccentButtonBackgroundPointerOver}" />
                <Setter Property="PressedBackground" Value="{DynamicResource AccentButtonBackgroundPressed}" />
                <Setter Property="Foreground" Value="{DynamicResource AccentButtonForeground}" />
                <Setter Property="PressedForeground" Value="{DynamicResource AccentButtonForegroundPointerOver}" />
                <Setter Property="BorderBrush" Value="{DynamicResource AccentControlElevationBorderBrush}" />
                <Setter Property="PressedBorderBrush" Value="{DynamicResource AccentButtonBorderBrushPressed}" />
            </Trigger>

            <!--  DARK  -->
            <Trigger Property="Appearance" Value="Dark">
                <Setter Property="Background">
                    <Setter.Value>
                        <SolidColorBrush Color="{DynamicResource ControlStrongFillColorDark}" />
                    </Setter.Value>
                </Setter>
                <Setter Property="MouseOverBackground">
                    <Setter.Value>
                        <SolidColorBrush Color="#62000000" />
                    </Setter.Value>
                </Setter>
                <Setter Property="PressedBackground">
                    <Setter.Value>
                        <SolidColorBrush Color="#52000000" />
                    </Setter.Value>
                </Setter>
                <Setter Property="Foreground">
                    <Setter.Value>
                        <SolidColorBrush Color="{DynamicResource TextFillColorLightPrimary}" />
                    </Setter.Value>
                </Setter>
                <Setter Property="PressedForeground">
                    <Setter.Value>
                        <SolidColorBrush Color="{DynamicResource TextFillColorLightSecondary}" />
                    </Setter.Value>
                </Setter>
            </Trigger>

            <!--  LIGHT  -->
            <Trigger Property="Appearance" Value="Light">
                <Setter Property="Background">
                    <Setter.Value>
                        <SolidColorBrush Color="{DynamicResource ControlStrongFillColorLight}" />
                    </Setter.Value>
                </Setter>
                <Setter Property="MouseOverBackground">
                    <Setter.Value>
                        <SolidColorBrush Color="#D3FFFFFF" />
                    </Setter.Value>
                </Setter>
                <Setter Property="PressedBackground">
                    <Setter.Value>
                        <SolidColorBrush Color="#F3FFFFFF" />
                    </Setter.Value>
                </Setter>
                <Setter Property="Foreground">
                    <Setter.Value>
                        <SolidColorBrush Color="{DynamicResource TextFillColorDarkPrimary}" />
                    </Setter.Value>
                </Setter>
                <Setter Property="PressedForeground">
                    <Setter.Value>
                        <SolidColorBrush Color="{DynamicResource TextFillColorDarkSecondary}" />
                    </Setter.Value>
                </Setter>
            </Trigger>

            <!--  INFO  -->
            <Trigger Property="Appearance" Value="Info">
                <Setter Property="Background">
                    <Setter.Value>
                        <SolidColorBrush Color="{DynamicResource PaletteLightBlueColor}" />
                    </Setter.Value>
                </Setter>
                <Setter Property="MouseOverBackground">
                    <Setter.Value>
                        <SolidColorBrush Opacity="0.9" Color="{DynamicResource PaletteLightBlueColor}" />
                    </Setter.Value>
                </Setter>
                <Setter Property="PressedBackground">
                    <Setter.Value>
                        <SolidColorBrush Opacity="0.7" Color="{DynamicResource PaletteLightBlueColor}" />
                    </Setter.Value>
                </Setter>
                <Setter Property="Foreground">
                    <Setter.Value>
                        <SolidColorBrush Color="{DynamicResource TextFillColorLightPrimary}" />
                    </Setter.Value>
                </Setter>
            </Trigger>

            <!--  DANGER  -->
            <Trigger Property="Appearance" Value="Danger">
                <Setter Property="Background">
                    <Setter.Value>
                        <SolidColorBrush Color="{DynamicResource PaletteRedColor}" />
                    </Setter.Value>
                </Setter>
                <Setter Property="MouseOverBackground">
                    <Setter.Value>
                        <SolidColorBrush Opacity="0.9" Color="{DynamicResource PaletteRedColor}" />
                    </Setter.Value>
                </Setter>
                <Setter Property="PressedBackground">
                    <Setter.Value>
                        <SolidColorBrush Opacity="0.7" Color="{DynamicResource PaletteRedColor}" />
                    </Setter.Value>
                </Setter>
            </Trigger>

            <!--  SUCCESS  -->
            <Trigger Property="Appearance" Value="Success">
                <Setter Property="Background">
                    <Setter.Value>
                        <SolidColorBrush Color="{DynamicResource PaletteGreenColor}" />
                    </Setter.Value>
                </Setter>
                <Setter Property="MouseOverBackground">
                    <Setter.Value>
                        <SolidColorBrush Opacity="0.9" Color="{DynamicResource PaletteGreenColor}" />
                    </Setter.Value>
                </Setter>
                <Setter Property="PressedBackground">
                    <Setter.Value>
                        <SolidColorBrush Opacity="0.7" Color="{DynamicResource PaletteGreenColor}" />
                    </Setter.Value>
                </Setter>
            </Trigger>

            <!--  CAUTION  -->
            <Trigger Property="Appearance" Value="Caution">
                <Setter Property="Background">
                    <Setter.Value>
                        <SolidColorBrush Color="{DynamicResource PaletteOrangeColor}" />
                    </Setter.Value>
                </Setter>
                <Setter Property="MouseOverBackground">
                    <Setter.Value>
                        <SolidColorBrush Opacity="0.9" Color="{DynamicResource PaletteOrangeColor}" />
                    </Setter.Value>
                </Setter>
                <Setter Property="PressedBackground">
                    <Setter.Value>
                        <SolidColorBrush Opacity="0.7" Color="{DynamicResource PaletteOrangeColor}" />
                    </Setter.Value>
                </Setter>
            </Trigger>
        </Style.Triggers>
    </Style>
    <!--#endregion-->

    <!--#region SelectorWindow-->
    <Style TargetType="{x:Type controls:SelectorWindow}" BasedOn="{StaticResource {x:Type Window}}">
        <Setter Property="ResizeMode" Value="NoResize"/>
        <Setter Property="WindowStyle" Value="None"/>
        <Setter Property="AllowsTransparency" Value="True"/>
        <Setter Property="Topmost" Value="True"/>
        <Setter Property="ShowInTaskbar" Value="False"/>
        <Setter Property="Background" Value="#AA9999FF"/>
    </Style>
    <!--#endregion-->

    <!--#region ToggleButton-->
    <Style TargetType="{x:Type controls:ToggleButton}" BasedOn="{StaticResource {x:Type Button}}">
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type controls:ToggleButton}">
                    <Grid>
                        <Rectangle Fill="{TemplateBinding Background}" Stroke="{TemplateBinding Foreground}" RadiusX="6" RadiusY="6"/>
                        <TextBlock Text="{TemplateBinding Content}" Margin="4" FontSize="12"
                            HorizontalAlignment="Center" VerticalAlignment="Center"/>
                    </Grid>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
        <Style.Triggers>
            <Trigger Property="IsChecked" Value="True">
                <Setter Property="Content" Value="{Binding CheckedContent,RelativeSource={RelativeSource Self}}"/>
                <Setter Property="Foreground" Value="{DynamicResource AccentButtonForeground}"/>
                <Setter Property="Background" Value="{DynamicResource AccentButtonBackground}"/>
            </Trigger>
            <Trigger Property="IsChecked" Value="False">
                <Setter Property="Content" Value="{Binding UncheckedContent,RelativeSource={RelativeSource Self}}"/>
                <Setter Property="Foreground" Value="{DynamicResource ButtonForeground}"/>
                <Setter Property="Background" Value="{DynamicResource ButtonBackground}"/>
            </Trigger>
        </Style.Triggers>
    </Style>
    <!--#endregion-->

    <!--#region CardToggleSwitch-->
    <Style TargetType="{x:Type controls:CardToggleSwitch}">
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type controls:CardToggleSwitch}">
                    <ui:CardControl Icon="{TemplateBinding Icon}" Header="{TemplateBinding Content}">
                        <ui:ToggleSwitch IsChecked="{Binding IsChecked,RelativeSource={RelativeSource TemplatedParent}}"/>
                    </ui:CardControl>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>
    <!--#endregion-->

    <!--#region InterceptorRuleCard-->
    <Style TargetType="{x:Type controls:InterceptorRuleCard}">
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate>
                    <VirtualizingStackPanel>
                        <ItemsPresenter/>
                    </VirtualizingStackPanel>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
        <Setter Property="ItemTemplate">
            <Setter.Value>
                <DataTemplate>
                    <ui:CardControl Header="{Binding WindowTitle}">
                        <WrapPanel>
                            <WrapPanel.Resources>
                                <Style TargetType="Border" BasedOn="{StaticResource ElementBorder}"/>
                                <Style TargetType="ui:Button" BasedOn="{StaticResource IconOnlyUIButton}"/>
                            </WrapPanel.Resources>

                            <Border>
                                <ui:TextBlock Text="{Binding BlockedCount}" VerticalAlignment="Center"/>
                            </Border>
                            <Border>
                                <ui:ToggleSwitch IsChecked="{Binding IsActive}" 
                                    Command="{Binding SaveRuleCommand,RelativeSource={RelativeSource AncestorType=controls:InterceptorRuleCard}}"
                                    VerticalAlignment="Center"/>
                            </Border>
                            <Border>
                                <controls:ToggleButton IsChecked="{Binding IsWindowClass}"
                                    Command="{Binding SaveRuleCommand,RelativeSource={RelativeSource AncestorType=controls:InterceptorRuleCard}}"
                                    VerticalAlignment="Center"
                                    CheckedContent="Class" UncheckedContent="Title"/>
                            </Border>
                            <Border>
                                <ui:Button Command="{Binding RemoveRuleCommand,RelativeSource={RelativeSource AncestorType=controls:InterceptorRuleCard}}"
                                    Appearance="Danger" VerticalAlignment="Center">
                                    <ui:Button.CommandParameter>
                                        <MultiBinding Converter="{StaticResource RemoveRuleParameterConverter}">
                                            <Binding Path="DataContext" RelativeSource="{RelativeSource AncestorType=controls:InterceptorRuleCard}"/>
                                            <Binding/>
                                        </MultiBinding>
                                    </ui:Button.CommandParameter>
                                    <ui:Button.Icon>
                                        <ui:SymbolIcon Symbol="Delete16"/>
                                    </ui:Button.Icon>
                                </ui:Button>
                            </Border>
                        </WrapPanel>
                    </ui:CardControl>
                </DataTemplate>
            </Setter.Value>
        </Setter>
    </Style>
    <!--#endregion-->

    <!--#region InterceptorRulesCard-->
    <Style TargetType="{x:Type controls:InterceptorRulesCard}">
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate>
                    <VirtualizingStackPanel>
                        <ItemsPresenter/>
                    </VirtualizingStackPanel>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
        <Setter Property="ItemTemplate">
            <Setter.Value>
                <DataTemplate>
                    <ui:CardExpander>
                        <ui:CardExpander.Header>
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="auto"/>
                                </Grid.ColumnDefinitions>

                                <ui:TextBlock Grid.Column="0" Text="{Binding ProcessName}" VerticalAlignment="Center"/>
                                <WrapPanel Grid.Column="1">
                                    <WrapPanel.Resources>
                                        <Style TargetType="Border" BasedOn="{StaticResource ElementBorder}"/>
                                        <Style TargetType="ui:Button" BasedOn="{StaticResource IconOnlyUIButton}"/>
                                    </WrapPanel.Resources>

                                    <Border>
                                        <ui:TextBlock Text="{Binding BlockedCount}" VerticalAlignment="Center"/>
                                    </Border>
                                    <Border>
                                        <ui:ToggleSwitch IsChecked="{Binding IsActive}"
                                            Command="{Binding SaveRuleCommand,RelativeSource={RelativeSource AncestorType=controls:InterceptorRulesCard}}"
                                            VerticalAlignment="Center"/>
                                    </Border>
                                    <Border>
                                        <ui:Button Command="{Binding ResetCountCommand,RelativeSource={RelativeSource AncestorType=controls:InterceptorRulesCard}}"
                                            CommandParameter="{Binding}"
                                            VerticalAlignment="Center">
                                            <ui:Button.Icon>
                                                <ui:SymbolIcon Symbol="ArrowCounterclockwise16"/>
                                            </ui:Button.Icon>
                                        </ui:Button>
                                    </Border>
                                    <Border>
                                        <ui:Button Command="{Binding RemoveRuleCommand,RelativeSource={RelativeSource AncestorType=controls:InterceptorRulesCard}}"
                                            Appearance="Danger" VerticalAlignment="Center">
                                            <ui:Button.CommandParameter>
                                                <MultiBinding Converter="{StaticResource RemoveRuleParameterConverter}">
                                                    <Binding/>
                                                    <Binding Source="{x:Null}"/>
                                                </MultiBinding>
                                            </ui:Button.CommandParameter>
                                            <ui:Button.Icon>
                                                <ui:SymbolIcon Symbol="Delete16"/>
                                            </ui:Button.Icon>
                                        </ui:Button>
                                    </Border>
                                </WrapPanel>
                            </Grid>
                        </ui:CardExpander.Header>

                        <controls:InterceptorRuleCard ItemsSource="{Binding Rules}"
                            SaveRuleCommand="{Binding SaveRuleCommand,RelativeSource={RelativeSource AncestorType=controls:InterceptorRulesCard}}"
                            RemoveRuleCommand="{Binding RemoveRuleCommand,RelativeSource={RelativeSource AncestorType=controls:InterceptorRulesCard}}"/>
                    </ui:CardExpander>
                </DataTemplate>
            </Setter.Value>
        </Setter>
    </Style>
    <!--#endregion-->
</ResourceDictionary>
